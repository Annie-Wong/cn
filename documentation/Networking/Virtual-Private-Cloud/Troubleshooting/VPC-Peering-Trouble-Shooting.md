# VPC peering 故障排除

### 环境描述
 
 当前环境为已创建两个VPC 须搭建VPC peering
 
 ### 故障问题
 
 1. vpc peering 连接一直处于初始化中
 
 解决方案：须创建对端VPC 对等连接，已当前连接的对端VPC作为本端VPC，当前连接的本端VPC的ID最为对端VPC ID创建VPC Peering，VPC peering是双向的，具体操作请参考[VPC对等连接](https://docs.jdcloud.com/cn/virtual-private-cloud/vpc-peering)
 
 2.如VPC1中的云主机不能与对端VPC2的中云主机进行通信
 
 解决方案：第一步，分别检查两端云主机所在子网的路由表是否配置，如未配置，则分别对子网关联的路由表进行配置，路由配置：目的端，分别为对端子网地址块；下一跳类型选择VPC 对等连接，下一跳选择对应VPC对等连接的名称，点击保存。
 
第二步，如第一步没有解决问题则进行此项，分别检查云主机所在子网是否绑定ACL，如绑定ACL，请分别确认两端ACL对通信的端口及源IP地址已放行，如未放行，则须配置一端ACL出规则，另一端ACL配置入规则，如需互相访问，须同时配置两端的出入站规则，如只配置出站规则，则只允许访问对方，不允许对方访问；如只配置入规则，则只允许该主机被访问，不允许访问对端。

第三步，如第二步未能解决问题则进行此项，分别检查云主机绑定的安全组，确认两端的安全的出入规则接受云主机进行通信采用的协议端口，并对对端云主机所在的子网地址块放行。通常默认安全组允许全部或部分端口开放，如使用默认安全组请确认通信端口被接受，如被拒绝，需配置相应的协议端口和地址，本端配置出规则，对端须配置相应的入规则，源IP分别为对端子网地址块和云主机IP，如需互相访问，须同时配置两端的出入规则。
