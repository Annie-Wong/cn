# 预检查说明

迁移任务启动后将先执行预检查，检查源库、目标库是否可连通及版本、设置等是否满足迁移要求，预检查通过后，才可执行数据库迁移。

以下为不同数据库类型的检查项，请在创建任务前提前检查相关项。



## MySQL

| 检查项                 | 检查内容                                                     |
| ---------------------- | ------------------------------------------------------------ |
| 源库连通性检查         | 检查源库是否可连通                                           |
| 源库权限检查           | 检查源库账号是否满足迁移要求                                 |
| 源库server_id检查      | 检查源库server_id是否大于1                                   |
| 源库binlog开启检查     | 检查源库是否开启binlog                                       |
| 源库binlog模式检查     | 检查源库binlog_format是ROW                                   |
| 源库binlogRowImage检查 | 检查源库binlog_row_image是FULL                               |
| 源库Schema存在性检查   | 检查源库是否存在待迁移Schema及_jdts_check__xxxx              |
| 源库Table存在性检查    | 检查源库是否存在待迁移Table                                  |
| 源库Table主键检查      | 检查源库Table是存在主键，需有主键才可迁移                    |
| 源库Table外键检查      | 检查源库Table是存在外键，需无外键才可迁移                    |
| 目标库连通性检查       | 检查目标库是否可连通                                         |
| 目标库Schema检查       | 检查目标库是否存在与待迁移数据同名的Schema及_jdts_check__xxxx |
| 数据库版本检查         | 检查源库与目标库数据库版本是否符合迁移要求                   |



## SQL Server

| 检查项               | 说明                                       |
| -------------------- | ------------------------------------------ |
| 源库连通性检查       | 源库连通性检查                             |
| 源库权限检查         | 检查源库账号是否满足迁移要求               |
| 源库DB存在性检查     | 检查源库是否存在待迁移DB                   |
| 源库Table存在性检查  | 检查源库是否存在待迁移DB                   |
| 源库Table主键检查    | 检查源库Table是存在主键，需有主键才可迁移  |
| 源库Recovery模式监控 | 检查源库Recovery模式是否为FULL             |
| 目标库连通性检查     | 检查目标库是否可连通                       |
| 目标库权限检查       | 检查目标库账号是否满足迁移要求             |
| 目标库DB存在性检查   | 检查目标库是否存在与待迁移数据同名的DB     |
| 数据库版本检查       | 检查源库与目标库数据库版本是否符合迁移要求 |



## PostgreSQL

| 检查项             | 说明                                       |
| ------------------ | ------------------------------------------ |
| 源库连通性检查     | 检查源库是否可连通                         |
| 源库权限检查       | 检查源库账号是否满足迁移要求               |
| 数据库hba检查      | 检查源库hba是否满足要求                    |
| 源库extension检查  | 检查源库extension                          |
| 源库max_sender检查 | 源库max_sender检查，应不小于5              |
| 源库max_slot检查   | 源库max_slot检查，应不小于5                |
| 源库wal_level检查  | 检查源库wal_level                          |
| 目标库连通性检查   | 检查目标库是否可连通                       |
| 目标库权限检查     | 检查目标库账号是否满足迁移要求             |
| 数据库版本检查     | 检查源库与目标库数据库版本是否符合迁移要求 |


## MongoDB

| 检查项                     | 说明                                           |
| -------------------------- | ---------------------------------------------- |
| 源库连通性检查             | 检查源库是否可连通                             |
| 源库权限检查               | 检查源库账号是否满足迁移要求                   |
| 源库版本检查               | 检查源库版本是否满足迁移要求                   |
| 源库Oplog检查              | 检查源库是否为副本集模式                       |
| 目标库连通性检查           | 检查目标库是否可连通                           |
| 目标库权限检查             | 检查目标库账号是否满足迁移要求                 |
| 目标库Collection存在性检查 | 检查目标库是否存在与待迁移数据同名的Collection |
| 目标库版本检查             | 检查目标库版本是否满足迁移要求                 |
