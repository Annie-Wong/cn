# 规则管理

将数据库添加到数据库审计系统后，您可以为数据库启用审计规则。当审计记录命中启用的审计规则时，则产生风险事件，并基于风险事件进行告警。

审计规则包括内置规则和用户自定义规则，规则隶属于不同的组。规则组可新建、启用、删除操作。规则可新建、编辑和删除操作。

- 内置规则，包括以下类型：审计规则、SQL注入规则、漏洞攻击规则、账号安全规则、数据泄露规则、违规操作规则等；每种类型下包括多条规则。不同的数据库支持的系统规则不同，具体以数据库审计的规则管理页面所罗列的可使用规则为准。
- 用户自定义规则，用户可以自定义规则所属组、规则基本信息、客户端信息、SQL、操作对象、结果及其他维度来细粒度定义审计规则。

## 添加规则组及规则

您可以通过控制台的数据库审计实例详情中的“规则管理”，添加、编辑、下发、删除审计规则。

![规则管理](/image/Database-Audit/规则管理.png)

点击**添加规则**，可将审计规则添加到已有规则组，填写规则名称，点击**确定**

![已有规则组](/image/Database-Audit/已有规则组.png)

也可将审计规则添加到新建规则组，填写规则组名称和规则名称，点击**确定**

![新建规则组](/image/Database-Audit/新建规则组.png)

## 编辑规则

您可以通过控制台的数据库审计实例详情中的“规则管理”，选中规则组下的规则，进行编辑。

![编辑规则](/image/Database-Audit/编辑规则.png)

编辑基本信息，包括规则名称、开启状态、选择风险等级、规则描述

![编辑基本信息](/image/Database-Audit/编辑基本信息.png)

编辑客户端信息，包括客户端IP、客户端工具、客户端操作系统用户、客户端操作系统主机名

![编辑客户端信息](/image/Database-Audit/编辑客户端信息.png)

编辑SQL信息，包括SQL语句、SQL关键字、SQL正则、特权操作、操作类型

![编辑SQL信息](/image/Database-Audit/编辑SQL信息.png)

编辑操作对象信息，包括表组、字段、数据库与Schema、目标表

![编辑操作对象](/image/Database-Audit/编辑操作对象.png)

编辑结果信息，包括响应时间、响应行数

![编辑结果信息](/image/Database-Audit/编辑结果信息.png)

编辑其它信息，包括查询组、数据库用户

![编辑其它信息](/image/Database-Audit/编辑其它信息.png)

## 启用规则组

您可以通过控制台的数据库审计实例详情中的“规则管理”，点击**启用**，即可启用规则组，系统目前支持以规则组的形式下发给不同的数据库。

![启用规则组](/image/Database-Audit/启用规则组.png)

选中需要监控审计的数据库，点击**确定**

![选择数据库](/image/Database-Audit/选择数据库.png)

## 删除规则组

您可以通过控制台的数据库审计实例详情中的“规则管理”，点击**删除**，即可删除规则组

![删除规则组](/image/Database-Audit/删除规则组.png)

## 删除规则

您可以通过控制台的数据库审计实例详情中的“规则管理”，选中规则组下的审计规则，点击**删除**，即可删除

![删除规则](/image/Database-Audit/删除规则.png)