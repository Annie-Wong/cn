## 		图片同步检测接口

本文提供了调用图片风险违规内容审核的接口和参数说明，旨在帮助您编写程序构建HTTP调用请求，有效地检测图片中的多维度风险内容。关于如何构造HTTP请求，请参见请求结构。

### 描述

同步检测图片中的违规内容，实时返回检测结果。

支持检测的场景包括：图片智能鉴黄、图片暴恐涉政识别

关于scene与label参数

在提交检测任务时，您需要指定scenes

**说明** 同时检测多个场景的情况下，将按照每个场景的检测图片数量×每个场景的单价进行累加计费。

而在检测返回结果中，则包含了您指定的场景对应的label结果分类参数。您可以根据suggestion参数的返回值对图片进行处置，根据label参数的返回值判断风险的具体类型。 

在图片审核中，scene与label的对应关系如下：

| 描述                       | scene     | label                                                        |
| :------------------------- | :-------- | :----------------------------------------------------------- |
| 识别图片中的色情内容。     | porn      | normal：正常图片，无色情内容<br />sexy：性感图片<br />porn：色情图片<br />vulgar：低俗图片<br />other：其他 |
| 识别图片中的暴恐涉政内容。 | terrorism | normal：正常图片  <br />bloody：血腥<br />explosion：爆炸烟光<br />weapon：武器<br />politics：涉政<br />terrorist：涉恐人物<br />riot ： 暴乱<br />flag：旗帜<br />other：其他 |


**关于检测时长**

同步检测允许的最长检测时间是6秒，如果检测在该时间限制内没有完成，系统会强制返回超时错误码。如果您对实时性要求不高，可以选择异步检测；其它情况下，请选择同步检测，同步检测接口的调用相对简单些。对于同步检测接口的调用，建议您将超时时间设置为6秒。

**关于图片的限制**

- 图片链接支持以下协议：HTTP和HTTPS。
- 图片支持以下格式：PNG、JPG、JPEG、BMP。
- 图片大小限制为5MB以内（适用于同步和异步调用）。如您有特殊需求（大图片），可以提工单进行调整。
- 图片下载时间限制为3s内，如果下载时间超过3s，返回下载超时。
- 图片像素建议不低于256*256，像素过低可能会影响识别效果。
- 图片检测接口响应时间依赖图片的下载时间。请保证被检测图片所在的存储服务稳定可靠，建议您使用京东云OSS存储或者CDN缓存等。

### 请求方式

POST

### 请求地址

 https://censor.jdcloud-api.com/v1/image:scan 

### 请求参数

关于在请求中必须包含的公共请求参数，请参见公共参数。

请求body是一个JSON对象，字段说明如下：

| 名称       | 类型        | 是否必需 | 默认值 | 描述                                                         |
| ---------- | ----------- | -------- | ------ | ------------------------------------------------------------ |
| **scenes** | String[]    | True     |        | 指定检测场景                                                 |
| **tasks**  | ImageTask[] | True     |        | 检测任务列表，包含一个或多个元素。每个元素是个结构体，最多可添加10个元素，即最多对10段文本进行检测。每个元素的具体结构描述见ImageTask。 |

#### ImageTask

| 名称       | 类型   | 是否必需 | 默认值 | 描述                                       |
| ---------- | ------ | -------- | ------ | ------------------------------------------ |
| **dataId** | String | False    |        | 数据Id。需要保证在一次请求中所有的Id不重复 |
| **url**    | String | True     |        | 待检测图像的URL, 支持jpg、png、bmp，最大5M |



### 返回参数

返回body中的data字段是JSON数组，每一个元素包含如下字段：

| 名称       | 类型   | 描述 |
| ---------- | ------ | ---- |
| **result** | Result |      |

#### Result

| 名称     | 类型          | 描述 |
| -------- | ------------- | ---- |
| **data** | ImageResult[] |      |

#### ImageResult

| 名称                | 类型    | 描述                                                         |
| ------------------- | ------- | ------------------------------------------------------------ |
| **code**            | Integer | 错误码，和HTTP的status code一致                              |
| **msg**             | String  | 错误描述信息                                                 |
| **dataId**          | String  | 对应请求的dataId                                             |
| **taskId**          | String  | 该检测任务的ID                                               |
| **content**         | String  | 对应请求的内容                                               |
| **filteredContent** | String  | 如果检测文本命中您自定义关键词词库中的词，该字段会返回，并将命中的关键词替换为"*" |
| **results**         | String  | 返回结果。调用成功时（code=200），返回结果中包含一个或多个元素。每个元素是个结构体，具体结构描述见result |

#### 返回码

| 返回码  | 描述                  |
| ------- | --------------------- |
| **200** | OK                    |
| **500** | Internal Server Error |
| **400** | Bad Request           |



#### 请求示例

```
{
  "scenes": [
    "porn"
  ],
  "tasks": [
    {
      "url": "http://xxx.xxx.xxx/img1.jpg"
    }
  ]
}
```

#### 返回示例

```
{
  "requestId": "bqfmguuo6d68mmbca0kw7cqeni8wmqqo",
  "result": {
    "data": [
      {
        "code": 200,
        "msg": "OK",
        "taskId": "imgd169fa6b-191c-45f6-a344-6dba8f4972ad",
        "results": [
          {
            "scene": "porn",
            "label": "normal",
            "score": 100,
            "suggestion": "pass"
          }
        ]
      }
    ]
  }
}
```

